More invisible bugfixes and upgrades
